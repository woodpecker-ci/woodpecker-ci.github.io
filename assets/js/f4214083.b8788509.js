"use strict";(self.webpackChunkwoodpecker=self.webpackChunkwoodpecker||[]).push([["1416"],{69060:function(e,o,n){n.r(o),n.d(o,{default:()=>u,frontMatter:()=>d,metadata:()=>r,assets:()=>a,toc:()=>c,contentTitle:()=>s});var r=JSON.parse('{"id":"administration/forges/addon","title":"Addon forges","description":"If the forge you\'re using does not comply with Woodpecker\'s requirements or your setup is too specific to be added to Woodpecker\'s core, you can write your own forge using an addon forge.","source":"@site/versioned_docs/version-3.0/30-administration/11-forges/100-addon.md","sourceDirName":"30-administration/11-forges","slug":"/administration/forges/addon","permalink":"/docs/administration/forges/addon","draft":false,"unlisted":false,"editUrl":"https://github.com/woodpecker-ci/woodpecker/edit/main/docs/versioned_docs/version-3.0/30-administration/11-forges/100-addon.md","tags":[],"version":"3.0","sidebarPosition":100,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Bitbucket Datacenter / Server","permalink":"/docs/administration/forges/bitbucket_datacenter"},"next":{"title":"Agent configuration","permalink":"/docs/administration/agent-config"}}'),i=n("96773"),t=n("16070");let d={},s="Addon forges",a={},c=[{value:"Usage",id:"usage",level:2},{value:"Bug reports",id:"bug-reports",level:3},{value:"List of addon forges",id:"list-of-addon-forges",level:2},{value:"Radicle Forge",id:"radicle-forge",level:3},{value:"Creating addon forges",id:"creating-addon-forges",level:2},{value:"Writing your code",id:"writing-your-code",level:3},{value:"Example structure",id:"example-structure",level:3}];function l(e){let o={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",strong:"strong",...(0,t.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(o.header,{children:(0,i.jsx)(o.h1,{id:"addon-forges",children:"Addon forges"})}),"\n",(0,i.jsxs)(o.p,{children:["If the forge you're using does not comply with ",(0,i.jsx)(o.a,{href:"/docs/development/core-ideas#forges",children:"Woodpecker's requirements"})," or your setup is too specific to be added to Woodpecker's core, you can write your own forge using an addon forge."]}),"\n",(0,i.jsx)(o.admonition,{type:"warning",children:(0,i.jsx)(o.p,{children:"Addon forges are still experimental. Their implementation can change and break at any time."})}),"\n",(0,i.jsx)(o.admonition,{type:"danger",children:(0,i.jsx)(o.p,{children:"You need to trust the author of the addon forge you use. It can access authentication codes and other possibly sensitive information."})}),"\n",(0,i.jsx)(o.h2,{id:"usage",children:"Usage"}),"\n",(0,i.jsx)(o.p,{children:"To use an addon forge, download the correct addon version. Then, you can add the following to your configuration:"}),"\n",(0,i.jsx)(o.pre,{children:(0,i.jsx)(o.code,{className:"language-ini",children:"WOODPECKER_ADDON_FORGE=/path/to/your/addon/forge/file\n"})}),"\n",(0,i.jsxs)(o.p,{children:["In case you run Woodpecker as container, you probably want to mount the addon binary to ",(0,i.jsx)(o.code,{children:"/opt/addons/"}),"."]}),"\n",(0,i.jsx)(o.h3,{id:"bug-reports",children:"Bug reports"}),"\n",(0,i.jsxs)(o.p,{children:["If you experience bugs, please check which component has the issue. If it's the addon, ",(0,i.jsx)(o.strong,{children:"do not raise an issue in the main repository"}),", but rather use the separate addon repositories. To check which component is responsible for the bug, look at the logs. Logs from addons are marked with a special field ",(0,i.jsx)(o.code,{children:"addon"})," containing their addon file name."]}),"\n",(0,i.jsx)(o.h2,{id:"list-of-addon-forges",children:"List of addon forges"}),"\n",(0,i.jsx)(o.h3,{id:"radicle-forge",children:"Radicle Forge"}),"\n",(0,i.jsxs)(o.p,{children:[(0,i.jsx)(o.a,{href:"https://radicle.xyz/",children:"Radicle"})," is an open source, peer-to-peer code collaboration stack built on Git. Radicle addon for Woodpecker CI can be found at ",(0,i.jsx)(o.a,{href:"https://explorer.radicle.gr/nodes/seed.radicle.gr/rad:z39Cf1XzrvCLRZZJRUZnx9D1fj5ws",children:"this repo"}),"."]}),"\n",(0,i.jsx)(o.h2,{id:"creating-addon-forges",children:"Creating addon forges"}),"\n",(0,i.jsxs)(o.p,{children:["Addons use RPC to communicate to the server and are implemented using the ",(0,i.jsxs)(o.a,{href:"https://github.com/hashicorp/go-plugin",children:[(0,i.jsx)(o.code,{children:"go-plugin"})," library"]}),"."]}),"\n",(0,i.jsx)(o.h3,{id:"writing-your-code",children:"Writing your code"}),"\n",(0,i.jsx)(o.p,{children:"This example will use the Go language."}),"\n",(0,i.jsxs)(o.p,{children:["Directly import Woodpecker's Go packages (",(0,i.jsx)(o.code,{children:"go.woodpecker-ci.org/woodpecker/v3"}),") and use the interfaces and types defined there."]}),"\n",(0,i.jsxs)(o.p,{children:["In the ",(0,i.jsx)(o.code,{children:"main"})," function, just call ",(0,i.jsx)(o.code,{children:'"go.woodpecker-ci.org/woodpecker/v3/server/forge/addon".Serve'})," with a ",(0,i.jsx)(o.code,{children:'"go.woodpecker-ci.org/woodpecker/v3/server/forge".Forge'})," as argument.\nThis will take care of connecting the addon forge to the server."]}),"\n",(0,i.jsx)(o.h3,{id:"example-structure",children:"Example structure"}),"\n",(0,i.jsx)(o.pre,{children:(0,i.jsx)(o.code,{className:"language-go",children:'package main\n\nimport (\n  "context"\n  "net/http"\n\n  "go.woodpecker-ci.org/woodpecker/v3/server/forge/addon"\n  forgeTypes "go.woodpecker-ci.org/woodpecker/v3/server/forge/types"\n  "go.woodpecker-ci.org/woodpecker/v3/server/model"\n)\n\nfunc main() {\n  addon.Serve(config{})\n}\n\ntype config struct {\n}\n\n// `config` must implement `"go.woodpecker-ci.org/woodpecker/v3/server/forge".Forge`. You must directly use Woodpecker\'s packages - see imports above.\n'})})]})}function u(e={}){let{wrapper:o}={...(0,t.a)(),...e.components};return o?(0,i.jsx)(o,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},16070:function(e,o,n){n.d(o,{Z:function(){return s},a:function(){return d}});var r=n(41699);let i={},t=r.createContext(i);function d(e){let o=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(o):{...o,...e}},[o,e])}function s(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),r.createElement(t.Provider,{value:o},e.children)}}}]);