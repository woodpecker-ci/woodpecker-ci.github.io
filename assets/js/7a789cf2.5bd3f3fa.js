/*! For license information please see 7a789cf2.5bd3f3fa.js.LICENSE.txt */
"use strict";(self.webpackChunkwoodpecker=self.webpackChunkwoodpecker||[]).push([[4170],{49886:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>u,frontMatter:()=>a,metadata:()=>r,toc:()=>d});var s=i(11527),t=i(97660);const a={},o="Services",r={id:"usage/services",title:"Services",description:"Woodpecker provides a services section in the Yaml file used for defining service containers. The below configuration composes database and cache containers.",source:"@site/versioned_docs/version-0.15/20-usage/60-services.md",sourceDirName:"20-usage",slug:"/usage/services",permalink:"/docs/0.15/usage/services",draft:!1,unlisted:!1,editUrl:"https://github.com/woodpecker-ci/woodpecker/edit/main/docs/versioned_docs/version-0.15/20-usage/60-services.md",tags:[],version:"0.15",sidebarPosition:60,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Example plugin",permalink:"/docs/0.15/usage/plugins/sample-plugin"},next:{title:"Volumes",permalink:"/docs/0.15/usage/volumes"}},c={},d=[{value:"Configuration",id:"configuration",level:2},{value:"Detachment",id:"detachment",level:2},{value:"Initialization",id:"initialization",level:2}];function l(e){const n={code:"code",h1:"h1",h2:"h2",p:"p",pre:"pre",...(0,t.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"services",children:"Services"}),"\n",(0,s.jsx)(n.p,{children:"Woodpecker provides a services section in the Yaml file used for defining service containers. The below configuration composes database and cache containers."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-diff",children:"pipeline:\n  build:\n    image: golang\n    commands:\n      - go build\n      - go test\n\nservices:\n  database:\n    image: mysql\n\n  cache:\n    image: redis\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Services are accessed using custom hostnames. In the above example the mysql service is assigned the hostname ",(0,s.jsx)(n.code,{children:"database"})," and is available at ",(0,s.jsx)(n.code,{children:"database:3306"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,s.jsx)(n.p,{children:"Service containers generally expose environment variables to customize service startup such as default usernames, passwords and ports. Please see the official image documentation to learn more."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-diff",children:"services:\n  database:\n    image: mysql\n+   environment:\n+     - MYSQL_DATABASE=test\n+     - MYSQL_ALLOW_EMPTY_PASSWORD=yes\n\n  cache:\n    image: redis\n"})}),"\n",(0,s.jsx)(n.h2,{id:"detachment",children:"Detachment"}),"\n",(0,s.jsx)(n.p,{children:"Service and long running containers can also be included in the pipeline section of the configuration using the detach parameter without blocking other steps. This should be used when explicit control over startup order is required."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-diff",children:"pipeline:\n  build:\n    image: golang\n    commands:\n      - go build\n      - go test\n\n  database:\n    image: redis\n+   detach: true\n\n  test:\n    image: golang\n    commands:\n      - go test\n"})}),"\n",(0,s.jsx)(n.p,{children:"Containers from detached steps will terminate when the pipeline ends."}),"\n",(0,s.jsx)(n.h2,{id:"initialization",children:"Initialization"}),"\n",(0,s.jsx)(n.p,{children:"Service containers require time to initialize and begin to accept connections. If you are unable to connect to a service you may need to wait a few seconds or implement a backoff."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-diff",children:"pipeline:\n  test:\n    image: golang\n    commands:\n+     - sleep 15\n      - go get\n      - go test\n\nservices:\n  database:\n    image: mysql\n"})})]})}function u(e={}){const{wrapper:n}={...(0,t.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},3354:(e,n,i)=>{var s=i(50959),t=Symbol.for("react.element"),a=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,r=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function d(e,n,i){var s,a={},d=null,l=null;for(s in void 0!==i&&(d=""+i),void 0!==n.key&&(d=""+n.key),void 0!==n.ref&&(l=n.ref),n)o.call(n,s)&&!c.hasOwnProperty(s)&&(a[s]=n[s]);if(e&&e.defaultProps)for(s in n=e.defaultProps)void 0===a[s]&&(a[s]=n[s]);return{$$typeof:t,type:e,key:d,ref:l,props:a,_owner:r.current}}n.Fragment=a,n.jsx=d,n.jsxs=d},11527:(e,n,i)=>{e.exports=i(3354)},97660:(e,n,i)=>{i.d(n,{Z:()=>r,a:()=>o});var s=i(50959);const t={},a=s.createContext(t);function o(e){const n=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);